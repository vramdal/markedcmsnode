Database structure
==================

The WebDAV tree is modeled as a single MongoDB collection, called `content`. Different types of documents are 
identified by the `resourceType` property, which can have these values:

  - `content`
  - `page`
  - `template`

The other properties depends on `resourceType`, but all documents have at least these properties:

  - `created` - date of creation
  - `lastModified` - date of last modification, or same as `created` if not modified since creation
  - `path` - path in the WebDAV hierarcy
  - `id` - collection-wide ID attribute, generated by MongoDB if not set explicitly
  

`page` documents
-----------------
    
    {
        "_id": "123abc",
        "title": "Front page",
        "resourceType": "page",
        "template": "frontpage",
        "slots": {
            "mainstory": "index.md",
            "substory": "documentation.md",
            "substory2": "substory2.md"
        },
        "lastModified": date,
        "path": "/",
        "language": "english"
    },
    {
        "_id": "456def",
        "title": "My first sub-page",
        "resourceType": "page",
        "template": "article",
        "slots": {
            "story": "some-story.md"
         },
         "lastModified": date,
         "path": "/my-first-subpage",
         "language": "english"
     }

    
The `template` property refers to a document in the `templates` collection. Properties of the `content` object
refers to documents in the `content` collection.

`template` documents
--------------------------

Templates may only exist in the `/templates` folder, so `path` will always be `/templates/templateName`.

     {
       "title": "Human-readable name",
       "resourceType": "template",
       "content": "Some Jade goes here",
       "lastModified": date,
       "size": 19, // bytes
       "path": "/templates/sometemplate.jade"
     }
     
`content` documents
------------------------
     
     {
       "content": "Some *Markdown*  goes here",
       "resourceType": "content",
       "lastModified": date,
       "path": "/my-first-subpage/mystory.md",
       "language": "english"
     }
     